## ğŸ“‹ æœ¬åœ°éªŒè¯ + IaCäº‘ä¸Šè¿ç§»è®¡åˆ’

### **Phase 1: æœ¬åœ°Multipassç¯å¢ƒéªŒè¯ï¼ˆ1-2å‘¨ï¼‰**

#### 1.1 ç¯å¢ƒå‡†å¤‡
- **1.1.1 éªŒè¯Multipassé›†ç¾¤**ï¼šç¡®è®¤è™šæ‹Ÿæœºèµ„æºï¼ˆ3èŠ‚ç‚¹é…ç½®ã€ç½‘ç»œäº’é€šï¼‰
- **1.1.2 é…ç½®ç®¡ç†å·¥å…·**ï¼šåœ¨**æœ¬åœ°å·¥ä½œæœº**å®‰è£… Terraformã€Ansibleã€Helmã€kubectlã€multipass
  - âš ï¸ **æ³¨æ„**ï¼šè¿™äº›å·¥å…·åªéœ€å®‰è£…åœ¨ä½ çš„å¼€å‘æœºä¸Šï¼Œä¸éœ€è¦åœ¨ VM èŠ‚ç‚¹å®‰è£…
  - **åŸå› **ï¼šé‡‡ç”¨é›†ä¸­å¼ç®¡ç†æ¨¡å¼ï¼Œé€šè¿‡ SSH/API è¿œç¨‹ç®¡ç†èŠ‚ç‚¹
  - **VM èŠ‚ç‚¹**ï¼šåªéœ€è¦å®‰è£… K3s å’ŒåŸºç¡€ç³»ç»Ÿä¾èµ–
- **1.1.3 ä»£ç ä»“åº“ç»“æ„**ï¼šå»ºç«‹IaCé¡¹ç›®ç›®å½•ç»“æ„

**åˆå§‹ç›®å½•ç»“æ„ï¼š**
```
gitops-infra/
â”œâ”€â”€ terraform/                    # Terraform IaCä»£ç 
â”‚   â”œâ”€â”€ modules/                 # å¯å¤ç”¨çš„Terraformæ¨¡å—ï¼ˆPhase 2åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ environments/            # ç¯å¢ƒç‰¹å®šé…ç½®
â”‚   â”‚   â””â”€â”€ local/              # æœ¬åœ°Multipassç¯å¢ƒ
â”‚   â”‚       â”œâ”€â”€ main.tf         # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ variables.tf    # å˜é‡å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ outputs.tf      # è¾“å‡ºå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ terraform.tfvars # å˜é‡å€¼ï¼ˆæœ¬åœ°ï¼‰
â”‚   â”‚       â””â”€â”€ backend.tf      # çŠ¶æ€åç«¯é…ç½®
â”‚   â””â”€â”€ scripts/                # Terraformè¾…åŠ©è„šæœ¬
â”‚       â”œâ”€â”€ init.sh             # åˆå§‹åŒ–è„šæœ¬
â”‚       â””â”€â”€ destroy.sh          # æ¸…ç†è„šæœ¬
â”‚
â”œâ”€â”€ ansible/                     # Ansibleé…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ inventory/              # ä¸»æœºæ¸…å•
â”‚   â”‚   â”œâ”€â”€ local/             # æœ¬åœ°ç¯å¢ƒä¸»æœº
â”‚   â”‚   â”‚   â””â”€â”€ hosts.ini      # MultipassèŠ‚ç‚¹åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ group_vars/        # ç»„å˜é‡
â”‚   â”‚       â””â”€â”€ all.yml        # å…¨å±€å˜é‡
â”‚   â”œâ”€â”€ playbooks/             # Ansible Playbook
â”‚   â”‚   â”œâ”€â”€ k3s-install.yml    # å®‰è£…K3sé›†ç¾¤
â”‚   â”‚   â”œâ”€â”€ k3s-reset.yml      # é‡ç½®é›†ç¾¤
â”‚   â”‚   â””â”€â”€ platform-setup.yml # éƒ¨ç½²å¹³å°æœåŠ¡
â”‚   â””â”€â”€ roles/                 # Ansibleè§’è‰²
â”‚       â”œâ”€â”€ k3s-master/        # K3sä¸»èŠ‚ç‚¹è§’è‰²
â”‚       â”œâ”€â”€ k3s-worker/        # K3så·¥ä½œèŠ‚ç‚¹è§’è‰²
â”‚       â””â”€â”€ common/            # é€šç”¨é…ç½®
â”‚
â”œâ”€â”€ kubernetes/                  # K8såŸç”Ÿèµ„æºå®šä¹‰
â”‚   â”œâ”€â”€ platform/               # å¹³å°æœåŠ¡ï¼ˆéGitOpsç®¡ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ namespaces/        # å‘½åç©ºé—´å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ rbac/              # RBACé…ç½®
â”‚   â”‚   â””â”€â”€ storage/           # å­˜å‚¨ç±»é…ç½®
â”‚   â””â”€â”€ manifests/             # ä¸´æ—¶æµ‹è¯•ç”¨manifests
â”‚
â”œâ”€â”€ gitops/                      # GitOpsé…ç½®ä»“åº“ï¼ˆArgoCDç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ apps/                   # åº”ç”¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ base/              # åŸºç¡€é…ç½®ï¼ˆKustomizeï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ kustomization.yaml
â”‚   â”‚   â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”‚   â”‚   â”œâ”€â”€ service.yaml
â”‚   â”‚   â”‚   â””â”€â”€ configmap.yaml
â”‚   â”‚   â””â”€â”€ overlays/          # ç¯å¢ƒå·®å¼‚é…ç½®
â”‚   â”‚       â”œâ”€â”€ local/         # æœ¬åœ°ç¯å¢ƒ
â”‚   â”‚       â”œâ”€â”€ dev/           # å¼€å‘ç¯å¢ƒ
â”‚   â”‚       â”œâ”€â”€ staging/       # é¢„å‘ç¯å¢ƒ
â”‚   â”‚       â””â”€â”€ production/    # ç”Ÿäº§ç¯å¢ƒ
â”‚   â”‚
â”‚   â””â”€â”€ platform/              # å¹³å°æœåŠ¡GitOpsé…ç½®
â”‚       â”œâ”€â”€ argocd/            # ArgoCDè‡ªèº«é…ç½®
â”‚       â”‚   â”œâ”€â”€ applications/  # Application CRD
â”‚       â”‚   â””â”€â”€ projects/      # Projectå®šä¹‰
â”‚       â”œâ”€â”€ harbor/            # Harboré…ç½®
â”‚       â”‚   â””â”€â”€ values.yaml    # Helm values
â”‚       â””â”€â”€ monitoring/        # ç›‘æ§æ ˆé…ç½®
â”‚           â”œâ”€â”€ prometheus/
â”‚           â””â”€â”€ grafana/
â”‚
â”œâ”€â”€ helm/                        # Helm Chartsï¼ˆè‡ªå®šä¹‰ï¼‰
â”‚   â””â”€â”€ charts/                 # è‡ªå®šä¹‰Chartç›®å½•
â”‚       â””â”€â”€ .gitkeep
â”‚
â”œâ”€â”€ ci/                          # CI/CDé…ç½®
â”‚   â”œâ”€â”€ gitlab-ci/              # GitLab CIæ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ .gitlab-ci.yml     # ä¸»CIé…ç½®
â”‚   â”‚   â”œâ”€â”€ templates/         # CIæ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ build.yml      # æ„å»ºæ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ test.yml       # æµ‹è¯•æ¨¡æ¿
â”‚   â”‚   â”‚   â””â”€â”€ deploy.yml     # éƒ¨ç½²æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ scripts/           # CIè„šæœ¬
â”‚   â”‚       â”œâ”€â”€ build.sh
â”‚   â”‚       â””â”€â”€ push-image.sh
â”‚   â””â”€â”€ github-actions/         # GitHub Actionsï¼ˆå¤‡ç”¨ï¼‰
â”‚
â”œâ”€â”€ configs/                     # é…ç½®æ–‡ä»¶é›†ä¸­ç®¡ç†
â”‚   â”œâ”€â”€ harbor/                 # Harboré…ç½®
â”‚   â”‚   â”œâ”€â”€ values-local.yaml  # æœ¬åœ°ç¯å¢ƒ
â”‚   â”‚   â””â”€â”€ values-cloud.yaml  # äº‘ç¯å¢ƒ
â”‚   â”œâ”€â”€ argocd/                # ArgoCDé…ç½®
â”‚   â”‚   â””â”€â”€ values-local.yaml
â”‚   â””â”€â”€ monitoring/            # ç›‘æ§é…ç½®
â”‚       â”œâ”€â”€ prometheus-values.yaml
â”‚       â””â”€â”€ grafana-values.yaml
â”‚
â”œâ”€â”€ scripts/                     # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ setup/                  # ç¯å¢ƒæ­å»ºè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ 01-install-tools.sh      # å®‰è£…å·¥å…·
â”‚   â”‚   â”œâ”€â”€ 02-create-multipass.sh   # åˆ›å»ºMultipass VM
â”‚   â”‚   â”œâ”€â”€ 03-deploy-k3s.sh        # éƒ¨ç½²K3s
â”‚   â”‚   â””â”€â”€ 04-deploy-platform.sh   # éƒ¨ç½²å¹³å°æœåŠ¡
â”‚   â”œâ”€â”€ backup/                 # å¤‡ä»½è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ backup-etcd.sh     # å¤‡ä»½etcd
â”‚   â”‚   â”œâ”€â”€ backup-harbor.sh   # å¤‡ä»½Harbor
â”‚   â”‚   â””â”€â”€ backup-all.sh      # å…¨é‡å¤‡ä»½
â”‚   â”œâ”€â”€ restore/                # æ¢å¤è„šæœ¬
â”‚   â”‚   â””â”€â”€ restore-cluster.sh
â”‚   â”œâ”€â”€ migrate/                # è¿ç§»è„šæœ¬ï¼ˆPhase 3ä½¿ç”¨ï¼‰
â”‚   â”‚   â””â”€â”€ migrate-to-cloud.sh
â”‚   â””â”€â”€ utils/                  # å·¥å…·è„šæœ¬
â”‚       â”œâ”€â”€ check-health.sh    # å¥åº·æ£€æŸ¥
â”‚       â””â”€â”€ cleanup.sh         # æ¸…ç†èµ„æº
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/           # æ¶æ„æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ overview.md        # æ¶æ„æ¦‚è§ˆ
â”‚   â”‚   â”œâ”€â”€ network.md         # ç½‘ç»œè®¾è®¡
â”‚   â”‚   â””â”€â”€ security.md        # å®‰å…¨è®¾è®¡
â”‚   â”œâ”€â”€ operations/            # è¿ç»´æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ installation.md    # å®‰è£…æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ deployment.md      # éƒ¨ç½²æµç¨‹
â”‚   â”‚   â””â”€â”€ monitoring.md      # ç›‘æ§é…ç½®
â”‚   â”œâ”€â”€ runbooks/              # æ“ä½œæ‰‹å†Œ
â”‚   â”‚   â”œâ”€â”€ troubleshooting.md # æ•…éšœæ’æŸ¥
â”‚   â”‚   â”œâ”€â”€ rollback.md        # å›æ»šæµç¨‹
â”‚   â”‚   â””â”€â”€ backup-restore.md  # å¤‡ä»½æ¢å¤
â”‚   â””â”€â”€ adr/                   # æ¶æ„å†³ç­–è®°å½•
â”‚       â””â”€â”€ 001-why-k3s.md
â”‚
â”œâ”€â”€ tests/                       # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ integration/            # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/                    # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚
â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .editorconfig               # ç¼–è¾‘å™¨é…ç½®
â”œâ”€â”€ Makefile                    # å¿«æ·å‘½ä»¤
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â””â”€â”€ plan.md                     # æœ¬è®¡åˆ’æ–‡æ¡£
```

**ç›®å½•åˆ›å»ºä¼˜å…ˆçº§ï¼š**

**Phase 1 Week 1ï¼ˆå¿…é¡»åˆ›å»ºï¼‰ï¼š**
- `terraform/environments/local/` - Terraformæœ¬åœ°é…ç½®
- `ansible/inventory/local/` - Ansibleä¸»æœºæ¸…å•
- `ansible/playbooks/` - K3séƒ¨ç½²è„šæœ¬
- `scripts/setup/` - è‡ªåŠ¨åŒ–å®‰è£…è„šæœ¬
- `configs/` - å¹³å°æœåŠ¡é…ç½®
- `docs/operations/` - åŸºç¡€æ–‡æ¡£

**Phase 1 Week 2ï¼ˆæŒ‰éœ€åˆ›å»ºï¼‰ï¼š**
- `gitops/platform/` - å¹³å°æœåŠ¡GitOpsé…ç½®
- `gitops/apps/base/` - åº”ç”¨åŸºç¡€é…ç½®
- `kubernetes/platform/` - K8såŸºç¡€èµ„æº
- `ci/gitlab-ci/` - CIé…ç½®æ¨¡æ¿

**Phase 2ï¼ˆæ¨¡å—åŒ–é˜¶æ®µåˆ›å»ºï¼‰ï¼š**
- `terraform/modules/` - Terraformå¯å¤ç”¨æ¨¡å—
- `terraform/environments/cloud-*/` - äº‘ç¯å¢ƒé…ç½®
- `gitops/apps/overlays/` - å¤šç¯å¢ƒå·®å¼‚é…ç½®

**Phase 3+ï¼ˆè¿ç§»é˜¶æ®µåˆ›å»ºï¼‰ï¼š**
- `scripts/migrate/` - äº‘è¿ç§»è„šæœ¬
- `scripts/backup/restore/` - å¤‡ä»½æ¢å¤
- `helm/charts/` - è‡ªå®šä¹‰Charts
- `tests/` - è‡ªåŠ¨åŒ–æµ‹è¯•

#### 1.2 åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆæœ¬åœ°ç‰ˆï¼‰
- **K3séƒ¨ç½²è„šæœ¬**ï¼šä½¿ç”¨Ansible Playbookè‡ªåŠ¨åŒ–éƒ¨ç½²K3sé›†ç¾¤
- **Terraformæœ¬åœ°é…ç½®**ï¼šå®šä¹‰æœ¬åœ°èµ„æºï¼ˆè™šæ‹Ÿæœºã€ç½‘ç»œé…ç½®ï¼‰
- **Helm Valuesç®¡ç†**ï¼šä¸ºä¸åŒç¯å¢ƒå‡†å¤‡é…ç½®æ–‡ä»¶ï¼ˆlocal/dev/staging/prodï¼‰

#### 1.3 å¹³å°æœåŠ¡éƒ¨ç½²ï¼ˆIaCæ–¹å¼ï¼‰
- **Terraform + Helm**ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²Harborã€ArgoCDã€Prometheus
- **é…ç½®å¤–éƒ¨åŒ–**ï¼šæ‰€æœ‰é…ç½®é€šè¿‡å˜é‡ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç 
- **çŠ¶æ€ç®¡ç†**ï¼šTerraformçŠ¶æ€æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

#### 1.4 CI/CDæµç¨‹éªŒè¯
- **æœ¬åœ°GitLab Runner**ï¼šåœ¨Multipassé›†ç¾¤ä¸Šè¿è¡Œ
- **æµ‹è¯•å®Œæ•´æµç¨‹**ï¼šä»£ç æäº¤ â†’ CIæ„å»º â†’ æ¨é€Harbor â†’ ArgoCDéƒ¨ç½²
- **éªŒè¯ä¸‰ç¯å¢ƒ**ï¼šdev/staging/production namespaceéš”ç¦»

---

### **Phase 2: IaCæŠ½è±¡ä¸æ¨¡å—åŒ–ï¼ˆç¬¬3å‘¨ï¼‰**

#### 2.1 Terraformæ¨¡å—è®¾è®¡
```
terraform/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ k3s-cluster/       # é›†ç¾¤åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ harbor/            # é•œåƒä»“åº“
â”‚   â”œâ”€â”€ argocd/            # GitOpså¼•æ“
â”‚   â”œâ”€â”€ monitoring/        # ç›‘æ§æ ˆ
â”‚   â””â”€â”€ networking/        # ç½‘ç»œé…ç½®
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ local/             # æœ¬åœ°Multipass
â”‚   â”œâ”€â”€ cloud-dev/         # äº‘ä¸Šå¼€å‘ç¯å¢ƒ
â”‚   â””â”€â”€ cloud-prod/        # äº‘ä¸Šç”Ÿäº§ç¯å¢ƒ
â””â”€â”€ provider-configs/
    â”œâ”€â”€ multipass.tf       # æœ¬åœ°Provider
    â”œâ”€â”€ tencentcloud.tf    # è…¾è®¯äº‘Provider
    â””â”€â”€ alicloud.tf        # é˜¿é‡Œäº‘Provider
```

#### 2.2 é…ç½®å·®å¼‚åŒ–ç®¡ç†
- **ç¯å¢ƒå˜é‡åˆ†ç¦»**ï¼šlocal.tfvarsã€dev.tfvarsã€prod.tfvars
- **äº‘å¹³å°é€‚é…**ï¼šæŠ½è±¡è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œèµ„æºå®šä¹‰
- **æ•æ„Ÿä¿¡æ¯ç®¡ç†**ï¼šä½¿ç”¨Terraform Cloudæˆ–Vaultå­˜å‚¨å¯†é’¥

#### 2.3 GitOpsé…ç½®ä»“åº“
```
gitops/
â”œâ”€â”€ apps/                  # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ base/             # åŸºç¡€é…ç½®ï¼ˆKustomizeï¼‰
â”‚   â””â”€â”€ overlays/
â”‚       â”œâ”€â”€ local/        # æœ¬åœ°ç¯å¢ƒ
â”‚       â”œâ”€â”€ dev/          # äº‘ä¸Šå¼€å‘
â”‚       â”œâ”€â”€ staging/      # äº‘ä¸Šé¢„å‘
â”‚       â””â”€â”€ production/   # äº‘ä¸Šç”Ÿäº§
â””â”€â”€ platform/             # å¹³å°æœåŠ¡é…ç½®
    â”œâ”€â”€ argocd/
    â”œâ”€â”€ harbor/
    â””â”€â”€ monitoring/
```

---

### **Phase 3: äº‘ç«¯è¿ç§»å‡†å¤‡ï¼ˆç¬¬4å‘¨ï¼‰**

#### 3.1 äº‘å¹³å°é€‰å‹ä¸é…ç½®
- **é€‰æ‹©äº‘å‚å•†**ï¼šè…¾è®¯äº‘TKE æˆ– é˜¿é‡Œäº‘ACKï¼ˆæ ¹æ®æˆæœ¬/åŒºåŸŸï¼‰
- **Terraform Provideré…ç½®**ï¼šäº‘å¹³å°APIè®¤è¯ã€åŒºåŸŸé€‰æ‹©
- **ç½‘ç»œè§„åˆ’**ï¼šVPCã€å­ç½‘ã€å®‰å…¨ç»„è§„åˆ™å®šä¹‰

#### 3.2 å·®å¼‚ç‚¹è¯†åˆ«ä¸é€‚é…
| èµ„æºç±»å‹ | æœ¬åœ°Multipass | äº‘å¹³å° | é€‚é…æ–¹æ¡ˆ |
|---------|-------------|--------|---------|
| **è®¡ç®—èµ„æº** | VM | CVM/ECS | ç»Ÿä¸€è§„æ ¼å˜é‡ |
| **å­˜å‚¨** | æœ¬åœ°ç£ç›˜ | äº‘ç›˜/CBS | æŠ½è±¡å­˜å‚¨ç±» |
| **è´Ÿè½½å‡è¡¡** | NodePort | CLB/SLB | Terraformæ¡ä»¶åˆ¤æ–­ |
| **åŸŸåDNS** | /etc/hosts | äº‘è§£æ | å¤–éƒ¨DNS Provider |
| **è¯ä¹¦** | è‡ªç­¾å | Let's Encrypt | Cert-Managerç»Ÿä¸€ |

#### 3.3 è¿ç§»è„šæœ¬å‡†å¤‡
- **æ•°æ®å¯¼å‡º**ï¼šHarboré•œåƒã€GitLabæ•°æ®ã€é…ç½®å¤‡ä»½
- **äº‘ç«¯åˆå§‹åŒ–**ï¼šTerraform applyï¼ˆäº‘ç¯å¢ƒï¼‰
- **æ•°æ®å¯¼å…¥**ï¼šè¿ç§»é•œåƒåˆ°äº‘ç«¯Harborã€æ¢å¤é…ç½®

---

### **Phase 4: äº‘ç«¯éƒ¨ç½²éªŒè¯ï¼ˆç¬¬5å‘¨ï¼‰**

#### 4.1 åŸºç¡€è®¾æ–½éƒ¨ç½²ï¼ˆå…¨è‡ªåŠ¨åŒ–ï¼‰
```bash
# ä¸€é”®éƒ¨ç½²åˆ°äº‘ç«¯
cd terraform/environments/cloud-dev
terraform init
terraform plan -var-file="dev.tfvars"
terraform apply -auto-approve
```

#### 4.2 åº”ç”¨è¿ç§»éªŒè¯
- **DNSåˆ‡æ¢æµ‹è¯•**ï¼šæœ¬åœ°â†’äº‘ç«¯æµé‡åˆ‡æ¢
- **å®Œæ•´CI/CDæµç¨‹**ï¼šåœ¨äº‘ç«¯ç¯å¢ƒè·‘é€š
- **æ€§èƒ½å¯¹æ¯”**ï¼šæœ¬åœ° vs äº‘ç«¯ï¼ˆæ„å»ºé€Ÿåº¦ã€éƒ¨ç½²æ—¶é—´ï¼‰

#### 4.3 ç¾éš¾æ¢å¤æ¼”ç»ƒ
- **å¤‡ä»½æ¢å¤æµ‹è¯•**ï¼šä»å¤‡ä»½æ¢å¤æ•´ä¸ªé›†ç¾¤
- **æ•…éšœåˆ‡æ¢**ï¼šæœ¬åœ°â†”äº‘ç«¯ç¯å¢ƒåˆ‡æ¢
- **RTO/RPOéªŒè¯**ï¼šç¡®ä¿æ¢å¤æ—¶é—´ç›®æ ‡è¾¾æ ‡

---

### **Phase 5: æŒç»­ä¼˜åŒ–ä¸äº¤ä»˜ï¼ˆç¬¬6å‘¨+ï¼‰**

#### 5.1 CI/CDæµæ°´çº¿ä¼˜åŒ–
- **Pipeline as Code**ï¼šGitLab CIé…ç½®ç‰ˆæœ¬åŒ–
- **å¤šç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²**ï¼šåŸºäºåˆ†æ”¯ç­–ç•¥è‡ªåŠ¨é€‰æ‹©ç¯å¢ƒ
- **æˆæœ¬ç›‘æ§**ï¼šäº‘èµ„æºä½¿ç”¨æƒ…å†µè·Ÿè¸ª

#### 5.2 æ–‡æ¡£ä¸äº¤ä»˜
- **IaCæ“ä½œæ‰‹å†Œ**ï¼šéƒ¨ç½²ã€æ›´æ–°ã€å›æ»šæµç¨‹
- **æ¶æ„å†³ç­–è®°å½•ï¼ˆADRï¼‰**ï¼šä¸ºä»€ä¹ˆé€‰æ‹©è¿™äº›å·¥å…·
- **æ•…éšœå¤„ç†æ‰‹å†Œ**ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

---

## ğŸ¯ å…³é”®é‡Œç¨‹ç¢‘

| æ—¶é—´èŠ‚ç‚¹ | äº¤ä»˜æˆæœ | éªŒæ”¶æ ‡å‡† |
|---------|---------|---------|
| **Week 2** | æœ¬åœ°Multipassç¯å¢ƒå®Œå…¨å¯ç”¨ | âœ… K3sé›†ç¾¤è¿è¡Œ<br>âœ… é¦–ä¸ªæœåŠ¡éƒ¨ç½²æˆåŠŸ |
| **Week 3** | IaCä»£ç æ¨¡å—åŒ–å®Œæˆ | âœ… Terraformæ¨¡å—å¯å¤ç”¨<br>âœ… å¤šç¯å¢ƒé…ç½®åˆ†ç¦» |
| **Week 4** | äº‘ç«¯ç¯å¢ƒå‡†å¤‡å°±ç»ª | âœ… Terraformä¸€é”®éƒ¨ç½²äº‘èµ„æº<br>âœ… é…ç½®å·®å¼‚åŒ–éªŒè¯é€šè¿‡ |
| **Week 5** | äº‘ç«¯å®Œæ•´éªŒè¯é€šè¿‡ | âœ… æ‰€æœ‰å¾®æœåŠ¡åœ¨äº‘ç«¯è¿è¡Œ<br>âœ… CI/CDæµç¨‹æ­£å¸¸ |
| **Week 6** | æ­£å¼äº¤ä»˜ | âœ… å®Œæ•´æ–‡æ¡£<br>âœ… å›¢é˜ŸåŸ¹è®­å®Œæˆ |

## ğŸ”§ æŠ€æœ¯æ ˆé€‰å‹

| ç±»å‹ | å·¥å…· | ç”¨é€” |
|------|------|------|
| **åŸºç¡€è®¾æ–½** | Terraform | äº‘èµ„æºç¼–æ’ï¼ˆæ”¯æŒå¤šäº‘ï¼‰ |
| **é…ç½®ç®¡ç†** | Ansible | K3så®‰è£…ã€èŠ‚ç‚¹é…ç½® |
| **åŒ…ç®¡ç†** | Helm | Kubernetesåº”ç”¨éƒ¨ç½² |
| **GitOps** | ArgoCD + Kustomize | åº”ç”¨é…ç½®ç®¡ç† |
| **ç‰ˆæœ¬æ§åˆ¶** | Git | IaCä»£ç å’ŒGitOpsé…ç½® |
| **çŠ¶æ€ç®¡ç†** | Terraform Cloud/åç«¯ | çŠ¶æ€æ–‡ä»¶è¿œç¨‹å­˜å‚¨ |

---

## ğŸ“ é¡¹ç›®ç»“æ„å»ºè®®

```
gitops-infra/
â”œâ”€â”€ terraform/              # åŸºç¡€è®¾æ–½å³ä»£ç 
â”‚   â”œâ”€â”€ modules/           # å¯å¤ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ environments/      # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ scripts/           # è¾…åŠ©è„šæœ¬
â”œâ”€â”€ ansible/               # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ inventory/         # ä¸»æœºæ¸…å•
â”‚   â”œâ”€â”€ playbooks/         # å‰§æœ¬
â”‚   â””â”€â”€ roles/             # è§’è‰²
â”œâ”€â”€ kubernetes/            # K8sèµ„æºå®šä¹‰
â”‚   â””â”€â”€ platform/          # å¹³å°æœåŠ¡
â”œâ”€â”€ gitops/                # GitOpsé…ç½®ä»“åº“
â”‚   â”œâ”€â”€ apps/              # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ platform/          # å¹³å°é…ç½®
â”œâ”€â”€ ci/                    # CIé…ç½®æ¨¡æ¿
â”‚   â””â”€â”€ gitlab-ci/
â”œâ”€â”€ scripts/               # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ backup.sh
â”‚   â”œâ”€â”€ restore.sh
â”‚   â””â”€â”€ migrate.sh
â””â”€â”€ docs/                  # æ–‡æ¡£
    â”œâ”€â”€ architecture.md
    â”œâ”€â”€ operations.md
    â””â”€â”€ runbooks/
```